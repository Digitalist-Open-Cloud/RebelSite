<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digitalist Agreement Form</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üìÑ</text></svg>">

</head>
<body>
    <div class="container">
        <div class="form-container">
            <h1>Digitalist Agreement Form</h1>
            <form id="agreementForm">
                <div class="form-group client-selector">
                    <label for="savedClients">Saved Clients</label>
                    <div class="client-selector-controls">
                        <select id="savedClients" name="savedClients">
                            <option value="">-- Select a client --</option>
                        </select>
                        <button type="button" id="deleteClientBtn" class="btn btn-danger" disabled>Delete Client</button>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="clientName">Client Company Name</label>
                    <input type="text" id="clientName" name="clientName" required>
                </div>
                
                <div class="form-group">
                    <label for="clientOrgNumber">Organization Number</label>
                    <input type="text" id="clientOrgNumber" name="clientOrgNumber" placeholder="123456-7890">
                </div>
                
                <div class="form-group">
                    <label for="clientAddress">Client Address</label>
                    <textarea id="clientAddress" name="clientAddress" rows="2" placeholder="Street address, Postal code, City"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="clientContactPerson">Contact Person</label>
                    <input type="text" id="clientContactPerson" name="clientContactPerson" required>
                </div>
                <div class="form-group">
                    <label for="clientSignatureName">Client Signature Name</label>
                    <input type="text" id="clientSignatureName" name="clientSignatureName" placeholder="Name of person signing for client" required>
                </div>
                <div class="form-group">
                    <label for="clientEmail">Contact Email</label>
                    <input type="email" id="clientEmail" name="clientEmail" required>
                </div>
                
                <div class="form-group">
                    <label for="clientPhone">Contact Phone (optional)</label>
                    <input type="tel" id="clientPhone" name="clientPhone">
                </div>

                <div class="form-group">
                    <label for="actionsPerMonth">Additional Actions per Month (Base: 500,000 included)</label>
                    <div class="slider-container">
                        <input type="range" id="actionsPerMonth" name="actionsPerMonth" 
                               min="0" max="49500000" step="100000" value="0">
                        <div class="slider-value">
                            <span id="actionsValue">500,000</span> actions/month
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="rawDataRetention">Raw Data Retention (Base: 180 days)</label>
                    <select id="rawDataRetention" name="rawDataRetention" required>
                        <option value="180">180 days (included)</option>
                        <option value="270">270 days</option>
                        <option value="365">365 days</option>
                        <option value="400">400 days</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="aggregatedDataRetention">Aggregated Data Retention (Base: 24 months)</label>
                    <select id="aggregatedDataRetention" name="aggregatedDataRetention" required>
                        <option value="24">24 months (included)</option>
                        <option value="36">36 months</option>
                        <option value="48">48 months</option>
                        <option value="60">60 months</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="additionalUsers">Additional Users (Base: 3 included, max 10 extra users at 190 SEK each)</label>
                    <div class="checkbox-group">
                        <input type="checkbox" id="unlimitedUsers" name="unlimitedUsers">
                        <label for="unlimitedUsers">Unlimited Users (+3000 SEK/month)</label>
                    </div>
                    <div id="additionalUsersContainer" class="slider-container">
                        <input type="range" id="additionalUsers" name="additionalUsers" 
                               min="0" max="10" step="1" value="0" disabled>
                        <div class="slider-value">
                            <span id="usersValue">3</span> total users
                        </div>
                    </div>
                </div>


                <div class="form-group">
                    <label for="startDate">Start Date</label>
                    <input type="date" id="startDate" name="startDate" required>
                </div>

                <div class="form-group">
                    <label for="endDate">End Date (optional)</label>
                    <input type="date" id="endDate" name="endDate">
                </div>
                

            </form>
        </div>
        <div class="summary-container">
            <div class="price-summary-box">
                <h3>Price Summary</h3>
                <div id="priceBreakdown" class="price-breakdown"></div>
                <div class="total-price">
                    <span>Total Monthly Price:</span>
                    <span id="totalPrice">0</span> SEK
                </div>
                <div class="summary-buttons">
                    <button type="submit" form="agreementForm" class="btn btn-primary">Create Agreement</button>
                </div>
            </div>
        </div>
    </div>
    <script src="./js/jspdf.umd.min.js"></script>
    <script src="./js/jspdf.plugin.autotable.min.js"></script>
    <!-- Preload clients data -->
    <script>
        // Fallback client data if fetch fails
        window.preloadedClients = {
          "Sobi": {
            "clientName": "Sobi",
            "clientOrgNumber": "556038-9321",
            "clientAddress": "Tomtebodav√§gen 23 A 171 65 Solna",
            "clientContactPerson": "Richard Hellquist",
            "clientEmail": "richard.Hellquist@sobi.com",
            "clientPhone": "",
            "clientSignatureName": "Richard Hellquist",
            "actionsPerMonth": 100000,
            "rawDataRetention": "180",
            "aggregatedDataRetention": "24",
            "unlimitedUsers": true,
            "additionalUsers": 0,
            "startDate": "2025-06-01",
            "endDate": ""
          },
          "L√§kare utan gr√§nser": {
            "clientName": "L√§kare utan gr√§nser",
            "clientOrgNumber": "802017-2360",
            "clientAddress": "Box 47021, 100 74 Stockholm",
            "clientContactPerson": "Johan Ros√©n",
            "clientEmail": "johan.rosen@lakareutangranser.se",
            "clientPhone": "",
            "clientSignatureName": "Johan Ros√©n",
            "actionsPerMonth": 4100000,
            "rawDataRetention": "180",
            "aggregatedDataRetention": "24",
            "unlimitedUsers": true,
            "additionalUsers": 0,
            "startDate": "2025-06-01",
            "endDate": ""
          }
        };
    </script>
    <script src="js/main.js"></script>

    <!-- Hidden agreement template with data attributes -->
    <template id="agreementTemplate">
        <div class="agreement-preview">
            <h1 data-pdf-title="true">Matomo SaaS Agreement</h1>
            
            <section data-pdf-section="specification">
                <h2>Specification and Sum of Monthly Costs</h2>
                <p><strong>Monthly Fee: <span data-agreement="total-price">0</span> SEK</strong></p>
                <ul>
                    <li>Including <span data-agreement="total-actions">500,000</span> actions per month</li>
                    <li><span data-agreement="total-users">3</span> user accounts (in Matomo)</li>
                    <li>Agreed data retention
                        <ul>
                            <li>Matomo Logs: <span data-agreement="raw-data-retention">180 days</span></li>
                            <li>Matomo Reports: <span data-agreement="aggregated-data-retention">24 months</span></li>
                            <li>RebelMetrics: 5 years</li>
                        </ul>
                    </li>
                    <li>Dimensions: 20 dimensions included in the base fee (10 action & 10 visitor)</li>
                    <li>1 GB of custom data in Superset (your own uploaded data - not Matomo data)</li>
                    <li>20k hits (requests) to Superset (per month)</li>
                </ul>
            </section>

            <section data-pdf-section="cost-breakdown">
                <h3>Cost Breakdown</h3>
                <table class="cost-table">
                    <thead>
                        <tr>
                            <th>Item</th>
                            <th>Description</th>
                            <th>Cost (SEK)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Base Price</td>
                            <td>500k actions + 3 users</td>
                            <td><span data-agreement="base-price">2999</span></td>
                        </tr>
                        <tr data-agreement-condition="has-extra-actions">
                            <td>Additional Actions</td>
                            <td><span data-agreement="extra-actions">0</span> extra actions (<span id="actionChunks">0</span> √ó 100k chunks)</td>
                            <td><span data-agreement="actions-price">0</span></td>
                        </tr>
                        <tr data-agreement-condition="has-unlimited-users">
                            <td>Unlimited Users</td>
                            <td>Unlimited user accounts</td>
                            <td><span data-agreement="users-price">0</span></td>
                        </tr>
                        <tr data-agreement-condition="has-extra-users">
                            <td>Additional Users</td>
                            <td><span id="additionalUsersCount">0</span> extra users (@ 190 SEK each)</td>
                            <td><span data-agreement="users-price">0</span></td>
                        </tr>
                        <tr data-agreement-condition="has-raw-data-upgrade">
                            <td>Raw Data Retention</td>
                            <td><span data-agreement="raw-data-retention">180 days</span> (upgrade from 180 days)</td>
                            <td><span data-agreement="raw-data-price">0</span></td>
                        </tr>
                        <tr data-agreement-condition="has-aggregated-data-upgrade">
                            <td>Aggregated Data Retention</td>
                            <td><span data-agreement="aggregated-data-retention">24 months</span> (upgrade from 24 months)</td>
                            <td><span data-agreement="aggregated-data-price">0</span></td>
                        </tr>
                        <tr class="total-row">
                            <td colspan="2"><strong>TOTAL MONTHLY COST</strong></td>
                            <td><strong><span data-agreement="total-price">0</span> SEK</strong></td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <section data-pdf-section="parties">
                <h2>Parties</h2>
                <p>This agreement for the delivery of Matomo as a cloud service (the Agreement) has been entered into between the parties below.</p>
                
                <h3>Client - <span data-agreement="client-name">[Client Name]</span></h3>
                <p id="clientOrgNumberParagraph">Org.nr: <span data-agreement="client-org-number">[Organization number]</span></p>
                <p id="clientAddressParagraph">Address: <span data-agreement="client-address">[Client address]</span></p>

                <h3>Supplier - Digitalist Open Cloud AB</h3>
                <p>Org.nr: 559469-9471<br>
                Address: Digitalist Open Cloud AB, Box 123, 123 45 Stockholm, Sweden<br>
                Phone: +46 123 456 78 90<br>
                Email: matomo@digitalist.com</p>
            </section>

            <section data-pdf-section="appendices">
                <h2>Agreement Appendices</h2>
                <p>The agreement consists of:</p>
                <ul>
                    <li>The Agreement (this document)</li>
                    <li><a href="https://drive.google.com/file/d/1WCPgFhq4eZoCpdg2SENo3VechAld6_hZ/view?usp=sharing" target="_blank">Special Terms Cloud Services Personal Data</a></li>
                    <li><a href="https://drive.google.com/file/d/1MxZN22D3DZ5DuPBH3UyqU8TiB0iQy8ni/view?usp=sharing" target="_blank">General Terms Cloud Services</a></li>
                    <li><a href="https://drive.google.com/file/d/1yJgnaX3fE4FS_l8t9ookSjcCBusQa3QL/view?usp=sharing" target="_blank">Business Ethics Principles</a></li>
                </ul>
                <p>If there are conflicting details in the Agreement, the documents have precedence in the order above.</p>
                <p>Digitalist is a member of Almega and pays for Tech Sweden's subscription to Digital Standard Agreements.</p>
            </section>
            
            <section data-pdf-section="background-purpose">
                <h2>Background and Purpose</h2>
                <p>The client needs to conduct measurement and analysis of websites and web applications in a secure and compliant manner.</p>
            </section>
            
            <section data-pdf-section="definitions">
                <h2>Definitions</h2>
                <p><strong>Application (and Third-Party Application):</strong> Matomo with premium plugins (premium bundles)<br>
                <strong>Product Supplier of Matomo:</strong> Innocraft develops and owns the roadmap for Matomo (Open Source) and offers premium plugins included in the Cloud Service.</p>
                <p>Defined words (words with a capital letter) whose definition is not found in this document or other appendices shall have the meaning as stated in the General Terms, unless otherwise stated in the document/context in which they are found.</p>
            </section>
            
            <section data-pdf-section="description-service">
                <h2>Description of the Service</h2>
                <p>Digitalist offers Matomo as a cloud service running on EU owned and controlled data centers. Digitalist takes full responsibility for ensuring that the service is available, and follows the rules and regulations that apply within the EU.</p>
                <p>We have nightly database backups and we store them for 30 days. We also have daily snapshots of the environment that we store for 7 days.</p>
                <p>The service also includes continuous scanning of vulnerabilities and continuous software updates to keep environments secure.</p>
                <p>See Specification (part of the Agreement).</p>
            </section>
            
            <section data-pdf-section="compensation">
                <h2>Compensation</h2>
                <p>See Price List (part of the Agreement).</p>
            </section>
            
            <section data-pdf-section="payment-terms">
                <h2>Payment Terms</h2>
                <h3>Initial Setup and Invoicing</h3>
                <p>Digitalist will invoice the Client quarterly in advance for:</p>
                <ul>
                    <li>Monthly fees as specified in the Price List</li>
                </ul>
                <p>The first invoice will be issued on the Actual Start Date, defined as the day when the Service is made available to the Client. This typically occurs within approximately 2 weeks after the agreement is signed, unless otherwise agreed.</p>
                <p>Digitalist will invoice the Client monthly in arrears for:</p>
                <ul>
                    <li>Hourly fees for ordered, performed, and reported work</li>
                    <li>Any costs for exceeding Actions according to the Price List</li>
                </ul>
            </section>
            
            <section data-pdf-section="payment">
                <h3>Payment</h3>
                <p>Payment must be received by Digitalist no later than 30 days after the invoice has been sent to the Client, unless a longer period is stated on the issued invoice.</p>
            </section>
            
            <section data-pdf-section="delay">
                <h3>Delay</h3>
                <p>In case of late payment, interest on arrears is charged according to the Interest Act (1975:635).</p>
            </section>
            
            <section data-pdf-section="contact-persons">
                <h2>Contact Persons</h2>
                <h3>The Client</h3>
                <p>Contact Person: <span data-agreement="client-contact-person">[Contact person]</span></p>
                <p>Email Address: <span data-agreement="client-email">[Email address]</span></p>
                <p id="clientPhoneParagraph">Phone: <span data-agreement="client-phone">[Phone number]</span></p>
            </section>
            
            <section data-pdf-section="terms">
                <h2>Terms</h2>
                <h3>Agreement Period</h3>
                <p>The agreement runs from <span data-agreement="start-date">[Start date]</span> <span id="endDateText">to <span data-agreement="end-date">[End date]</span></span>.</p>
            </section>
            
            <section data-pdf-section="notice-period">
                <h3>Notice Period/Extension Period</h3>
                <p>The agreement is extended quarterly unless terminated one (1) month before the next quarter begins.</p>
            </section>
            
            <section data-pdf-section="special-conditions">
                <h3>Special Conditions</h3>
                <p>None</p>
            </section>
            
            <section data-pdf-section="disclosures">
                <h2>Disclosures</h2>
                <p>Digitalist certifies that Digitalist:</p>
                <ul>
                    <li>is approved for F-tax</li>
                    <li>is VAT registered</li>
                    <li>has a collective agreement</li>
                    <li>has liability insurance up to one million kronor per year</li>
                </ul>
            </section>
            
            <section data-pdf-section="services">
                <h2>Services and Features</h2>
                <p>Services included in the agreement:</p>
                <ul>
                    <li>Matomo as a cloud service (with ongoing updates) for maximum security and stability</li>
                    <li>Matomo premium bundle (plugins)</li>
                    <li>Access to Support</li>
                    <li>RebelMetrics Dashboard</li>
                    <li>PII Tools</li>
                    <li>Rebel Ads</li>
                    <li>User Feedback</li>
                </ul>
            </section>
            
            <section data-pdf-section="additional-services">
                <h3>Additional Services and Costs</h3>
                <ul>
                    <li>Matomo migration - move your existing Matomo instance to our cloud service (12.000 SEK) *</li>
                    <li>Matomo expert services / hour (1600 SEK) *</li>
                    <li>Web analysis services / hour (1400 SEK) *</li>
                    <li>Exceeding Actions (149 SEK / 100k) ** - not prepaid, billed monthly in arrears</li>
                    <li>Extra storage in Superset (75 SEK / GB per month) *</li>
                    <li>Extra hits in Superset (175 SEK / 100k chunks) *</li>
                    <li>*Billing is done monthly in arrears</li>
                    <li>**149 SEK per 100k for ad-hoc overages vs 129 SEK per 100k for prepaid chunks</li>
                </ul>
            </section>
            <section data-pdf-section="additional-services-note">
                <p>If separate agreements for consultation between the parties exists, they override the prices in the price list.</p>
            </section> 
            
            <section data-pdf-section="index-adjustment">
                <h2>Index Adjustment</h2>
                <p>The supplier may, annually as from the start of a new calendar year, amend the agreed fees/hourly rates in accordance with the changes in Statistics Sweden's index: Labour Cost Index for tj√§nstem√§n (LCI tjm) preliminary index, SNI 2007</p>
                <p>Described in: <b>General Terms Cloud Services</b></p>
            </section>
            
            <section data-pdf-section="signatures">
                <h2>Signatures</h2>
                <div class="signature-section">
                    <div class="signature-block">
                        <h3>Client</h3>
                        <p><strong><span data-agreement="client-name">[Client Name]</span></strong></p>
                        <p><span data-agreement="client-signature-name">[Signatory name]</span></p>
                        <p>Date: _______________</p>
                        <p>_________________________________</p>
                        <p>Signature</p>
                    </div>
                    <div class="signature-block">
                        <h3>Digitalist</h3>
                        <p><strong>Digitalist Open Cloud AB</strong></p>
                        <p>Tomas Persson</p>
                        <p>Date: _______________</p>
                        <p>_________________________________</p>
                        <p>Signature</p>
                    </div>
                </div>
            </section>
        </div>
    </template>
  
</body>
</html>